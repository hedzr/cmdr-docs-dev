---
layout: single
title: "CLion 2022.3 EAP 支持 C++20 的 Modules 特性来"
date: 2022-10-24T05:20:00+08:00
last_modified_at: 2022-10-24T06:20:00+08:00
author: hedzr
draft: true
tags: [c++, c++11, c++20, modules]
categories: c++ algorithm
comments: true
toc: true
header:
  teaser: https://raw.githubusercontent.com/hzimg/blog-pics/master/uPic/image-20211019103247571.png
  overlay_image: /assets/images/3953273590_704e3899d5_m.jpg
  overlay_filter: rgba(16, 16, 32, 0.73)
excerpt: >-
  C++20 Modules 获得了更多支持...
---

状态

首先来说，Modules 这个特性在当前的 IDE/Editors 环境中已经获得了足够的支持，足够到我们可以顺利完成相当程度的开发任务，而不至于被 IDE 报错弄的无法继续。这意味着到目前为止，无论是 vscode 还是 CLion 至少不会拖后腿。而反过来说，要说 IDEs 的支持度有多深入呢，可能也就说不上了。

Modules 概述

[Modules](https://en.cppreference.com/w/cpp/language/modules) 是一个随 C++20 而来的新特性。它给 C++ 带来 Java/C#/Golang/Rust 等现代语言所采用的 “Package” 概念，以及对 “Package” 进行 import 的操作，目的是为大型工程的组织提供新的结构化能力，解决 #include 包含文件带来的种种负面影响。

CLion 2022.3 EAP 对此的支持

这个 EAP 的安装后占用空间大约为 3.09GB，真的是不可思议。都挺不可思议的，JetBrains 的全家桶都是相当吓人，不说它庞大的 Cache 占用以及 Application Supports 中的工作索引了，这些是动手删掉又会重建的东西，所以必须接受的，单单讲它们的应用程序安装后的尺寸，现在大约是这么个情况：

![image-20221024201824425](_assets/2022-10-24-cxx20-modules-in-clion/image-20221024201824425.png)

如果你真的信了他们家的邪，安装了 ToolBox 的话，那么 ToolBox 的 Application Supports 中将会有全家桶的安装包的副本，这些副本也会弄掉 7-15GB 的空间。

吐个槽而已，这就打住了。

> 忍不住想说，真正的疯子是 Xcode，吃掉了 16.6GB 的地盘，还不包括用于仿真器的 iOS 各种系统镜像所占用的空间。
>
> 当然幸好我现在远离了 Visual Studio，好像它们家的完整安装需要接近 100GB。即使如此，这还不包括完整的 DDKs，此外也没有完整的本地 MSDN 文档，这些东东也是超级庞大。
>
> 做程序员挣点钱都花在升级硬件上了。

关于 Modules，现在 CLion EAP 可以：

1. 从 .ixx, .cppm 和 .mxx 中搜集相关元数据
2. 处理 `export module {name}` 语句并在 `{name}` 和 module （及其文件名）之间建立关联关系
3. 基于上述的元数据提供代码高亮以及代码援助（包括自动完成等）

实测的结果不尽人意。代码高亮有点鸡肋，虽然它们（module name，function name）确实是被识别并高亮，但这个的用处有限。import 仍不能自动完成 module names，。

按照现有的迭代进度来推测的话，完全深入到方方面面的 Modules 支持，可能在 2022.4 也未必能抵达，恐怕要到明年年中时分的 2023.1 发布时再来评估其支持度了。

但如果你的工程已经开始迫不及待地依赖于 Modules，也没有特别大的关系，尽管这些 IDEs 还没有一个侧边栏能够罗列出全部已经扫描到的 modules，包括你的代码中的以及从系统或第三方引入的，但即使是在 vscode 中，现在也可以就地开始了。

[CLion 2022.3 EAP: C++20 Modules Now Supported! | The CLion Blog](https://blog.jetbrains.com/clion/2022/10/clion-2022-3-eap-cpp20-modules-now-supported/)

:end:
