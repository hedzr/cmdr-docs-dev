---
layout: single
title: "å…³äº Sonoma çš„ä½“éªŒ: golang"
date: 2023-10-02T08:00:00+08:00
last_modified_at: 2023-10-02T10:33:00+08:00
author: hedzr
tags: [macOS]
categories: lifestyle review
comments: true
toc: true
header:
  overlay_image: /images/3953273590_704e3899d5_m.jpg
  overlay_filter: rgba(255, 255, 255, 0.5)
excerpt: >-
  Sonoma æ¯”è¾ƒç¨³å®šï¼Œä½† golang ç¼–è¯‘å™¨æœ‰å¤§å †ä¸é€‚ `ld warning -bind_at_load`...
---

## çŠ¶å†µ

ç›®å‰ golang 1.20 æˆ–è€… 1.21 æœ‰å¤§é‡é—®é¢˜å‡ºç°ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯å› ä¸ºå’Œ Apple clang çš„ä¸é€‚é…è€Œäº§ç”Ÿçš„ã€‚å…¶ä¸­ä¸€äº›åªæ˜¯å¤šå‡ºäº†è­¦å‘Šä¿¡æ¯ï¼Œå¯ä»¥ä¸å¿…ç†ä¼šï¼Œä½†æœ‰çš„ä¿¡æ¯èƒ½å¤Ÿå¯¼è‡´ go test æœ€ç»ˆå¾—åˆ°å¤±è´¥ç»“æœï¼Œå“ªæ€•ä½ çš„å•å…ƒæµ‹è¯•å…¨éƒ½æ²¡é”™ã€‚ä¾‹å¦‚ï¼š

```bash
ld: warning: -bind_at_load is deprecated on macOS
```

ä¸€å¼€å§‹ï¼Œæˆ‘æ ¹æœ¬ä¸çŸ¥é“åŸå› ï¼Œæ‰€ä»¥å»æœ Sonoma ç›¸å…³ï¼Œå‡ æ— æ‰€è·ã€‚åæ¥å¶ç„¶å˜æ¢å…³é”®è¯ï¼Œç»“æœåœ¨ go.dev å¾—åˆ°äº†ä¸€äº›æç¤ºã€‚æ¯”æ–¹è¯´è¿™é‡Œï¼š

https://github.com/golang/go/issues/61229

ç½—åˆ—äº†å¤§å †å¯èƒ½è·çŸ¥çš„è­¦å‘Šä¿¡æ¯ï¼š

```bash
ld: warning: -bind_at_load is deprecated on macOS

ld: warning: search path '/usr/local/lib' not found

ld: warning: ignoring duplicate library '-lm'

ld: warning: '.../go.o' has malformed LC_DYSYMTAB, expected 92 undefined symbols to start at index 15983, found 102 undefined symbol
```

å®ƒä»¬ä¼šä¸åŒç¨‹åº¦åœ°å½±å“åˆ°ä½ çš„ golang ç¼–è¯‘ç»“æœã€è¿è¡Œå’Œæµ‹è¯•ç»“æœã€‚

æœ‰çš„æ¡ˆä¾‹å­˜åœ¨ä¸€äº› workaroundï¼Œä½†å½“æˆ‘ä¸€ä¸€æ£€è§†åéš¾å…å¤±æœ›ï¼Œå› ä¸ºåŸºæœ¬ä¸Šéƒ½æ˜¯ä¼¤ç­‹åŠ¨éª¨çš„æ‰‹æ³•ï¼Œå¹¶ä¸”æ¡ä»¶è‹›åˆ»ï¼›åˆæˆ–è€…è¯¥æ‰‹æ³•ä¼šäº§ç”Ÿé¢å¤–çš„å‰¯ä½œç”¨ã€‚è‡³å°‘å¯¹äºæˆ‘æ¥è¯´ï¼Œç»“è®ºæ˜¯å°šæ— å¯è¡Œçš„åŠæ³•é¿å¼€ä¸Šé¢å­˜åœ¨çš„é—®é¢˜ã€‚

æŒ‰ç…§ go.dev çš„é‡Œç¨‹ç¢‘å®‰æ’ï¼Œè¿™äº›æ¯›ç—…å°†åœ¨ go1.22 å‘å¸ƒæ—¶å¾—åˆ°è§£å†³ï¼Œå®é™…ä¸Šä¹Ÿå°±æ˜¯ç¼–è¯‘å™¨å¯¹ä¸Šè¿°è­¦å‘Šç›´æ¥ç•¥è¿‡å°±å¥½ã€‚ä½†æ˜¯æœ‰çš„ç­‰äº†ï¼Œå› ä¸ºæŒ‰ç…§ golang å‘è¡Œç­–ç•¥ï¼Œ1.22 åº”è¯¥ç­‰åˆ°æ˜å¹´ 2æœˆä»½æ‰ä¼šå‘å¸ƒã€‚åªæ˜¯ä¸çŸ¥é“å°‘æ•°å·²ç»ä¿®å¤çš„ issues ä¼šå¦è¢«æœ€è¿‘çš„ 1.21 patch æ‰€ä¼˜å…ˆå‘å¸ƒå‡ºæ¥ã€‚

> å·²æœ‰ä¸€äº›å’Œ Sonoma beta Xcode 15 beta ç›¸å…³çš„ä¿®è®¢å·²ç»è¢«åˆå¹¶åˆ° 1.21 ä¸»çº¿å¹¶ä¸”å‘è¡Œäº†ï¼Œä¾‹å¦‚ `cmd/link: use symbol-targeted relocation for initializers on Mach-O` ç­‰ç­‰ã€‚

## åè®°

ç›®å‰ï¼Œæˆ‘åªå…³å¿ƒç¨³å®šæ€§ã€‚

å¥½å­©å­ä¸æŠ˜è…¾ã€‚

golang bug-tracing boardï¼š

- https://go-review.googlesource.com/c/go/+/503538
- https://go-review.googlesource.com/c/go/+/503935
- https://go-review.googlesource.com/c/go/+/505415
- https://go-review.googlesource.com/c/go/+/502616

å…¶å®ƒ Sonoma ç¯å¢ƒæš‚æ—¶æ²¡æœ‰å‘ç°çŠ¶å†µï¼Œæ€»ä½“æ¥è¯´å¾ˆç¨³å®šï¼Œæ¯”ä¸Šä¸‰ä¸ªå¤§ç‰ˆæœ¬ç¨³å®šå¤šäº†ï¼Œå¯¹äºæˆ‘æ¥è¯´ã€‚

## ğŸ”š
